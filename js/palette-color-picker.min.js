!function(t){"use strict";t.paletteColorPicker=function(e,s){var a="palette-color-picker",o=t(e),n=this,i=o.val(),r=o.attr("name"),c=t("<div>").addClass(a+"-button").attr("data-target",r),l=t("<div>").addClass(a+"-bubble"),u={custom_class:null,colors:null,position:"upside",insert:"before",clear_btn:"first",timeout:2e3},d="ontouchstart"in document.documentElement?"touchstart":"click";n.init=function(){n.settings=t.extend({},u,s),null===n.settings.colors&&(n.settings.colors=o.data("palette")),"string"==typeof n.settings.colors[0]&&(n.settings.colors=t.map(n.settings.colors,function(t,e){var s={};return s[t]=t,s})),n.settings.insert=n.settings.insert.charAt(0).toUpperCase()+n.settings.insert.slice(1),n.settings.custom_class&&l.addClass(n.settings.custom_class),t.each(n.settings.colors,function(e,s){var a=Object.keys(s)[0],o=s[a],n=t("<span>").addClass("swatch").attr({title:a,"data-color":o,"data-name":a}).css("background-color",o);a===i&&(n.addClass("active"),c.css("background",o)),n.appendTo(l)});var e=t("<span>").addClass("swatch clear").attr("title","Clear selection");"last"===n.settings.clear_btn?e.addClass("last").appendTo(l):e.prependTo(l),n.destroy=function(){c.remove(),t.removeData(o[0])},c.append(l).on(d,function(e){e.preventDefault(),e.stopPropagation();var s=t(this);s.toggleClass("active").find("."+a+"-bubble").fadeToggle(),s.hasClass("active")&&(clearTimeout(n.timer),n.timer=setTimeout(function(){s.trigger("pcp.fadeout")},n.settings.timeout))}).on("pcp.fadeout",function(){t(this).removeClass("active").find("."+a+"-bubble").fadeOut()}).on("mouseenter","."+a+"-bubble",function(){clearTimeout(n.timer)}).on("mouseleave","."+a+"-bubble",function(){n.timer=setTimeout(function(){c.trigger("pcp.fadeout")},n.settings.timeout)}).on(d,"span.swatch",function(e){e.preventDefault(),e.stopPropagation();var s=t(this).attr("data-color"),o=t(this).attr("data-name"),n=t("."+a+'-button[data-target="'+t(this).closest("."+a+"-button").attr("data-target")+'"]'),i=t(this).closest("."+a+"-bubble");i.find(".active").removeClass("active"),t(e.target).is(".clear")?(n.removeAttr("style"),s=""):(t(this).addClass("active"),n.css("background",s)),t('[name="'+n.attr("data-target")+'"]').val(o)})["insert"+n.settings.insert](o),("downside"===n.settings.position||o.offset().top+20<l.outerHeight())&&l.addClass("downside")},n.init()},t.fn.paletteColorPicker=function(e){return this.each(function(){"undefined"==typeof t(this).data("paletteColorPickerPlugin")&&t(this).data("paletteColorPickerPlugin",new t.paletteColorPicker(this,e))})}}(jQuery);
